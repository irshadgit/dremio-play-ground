apiVersion: "sparkoperator.k8s.io/v1beta2"
kind: SparkApplication
metadata:
    name: spark-iceberg
    namespace: play-ground
spec:
    type: Python
    pythonVersion: "3"
    mode: cluster
    image: "openlake/sparkjob-demo:3.3.1"
    imagePullPolicy: IfNotPresent
    mainApplicationFile: local:////opt/spark-code/iceberg-load.py
    sparkVersion: "3.3.1"
    volumes:
      - name: spark-code
        configMap:
          name: spark-code-config-map    
    restartPolicy:
        type: OnFailure
        onFailureRetries: 3
        onFailureRetryInterval: 10
        onSubmissionFailureRetries: 5
        onSubmissionFailureRetryInterval: 20
    driver:
        cores: 1
        coreLimit: "1200m"
        memory: "512m"
        labels:
        
        serviceAccount: spark-operator-spark
        volumeMounts:
          - name: spark-code
            mountPath: /opt/spark-code
    executor:
        cores: 1
        instances: 1
        memory: "512m"
        labels:
        
        volumeMounts:
          - name: spark-code
            mountPath: /opt/spark-code

